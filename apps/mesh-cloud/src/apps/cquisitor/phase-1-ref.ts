import * as cqLib from "@cardananium/cquisitor-lib";
import JSONbig from "json-bigint";

const utxo1: cqLib.UTxO = JSON.parse(
  '{"input":{"outputIndex":1,"txHash":"6153c1e9a628fc2bc1ebc82d1f6b6d360c3f5a895171cfd8a792541ab51f7509"},"output":{"address":"addr1q80y4whnp6y5ajfy8w9mj7khg9936vyxsvad30cj6yqnp5r2vrs4j05rcf6n6w8wvxpar47dkzsutjax2lre3zz3y2nqh3h7xa","amount":[{"unit":"lovelace","quantity":"1784340"},{"unit":"6ac8ef33b510ec004fe11585f7c5a9f0c07f0c23428ab4f29c1d7d104d454c44","quantity":"5000000"},{"unit":"a0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235484f534b59","quantity":"20250010"},{"unit":"a2944573e99d2ed3055b808eaa264f0bf119e01fc6b18863067c63e44d454c44","quantity":"15015000994000"},{"unit":"b06729158210bf1ba13f8f3d7d422a918d3eaa82561a705552a2568b4d656c642042616e6b204d616e616765722076312033393937","quantity":"1"}]}}',
);
const utxo2: cqLib.UTxO = JSON.parse(
  '{"input":{"outputIndex":2,"txHash":"6153c1e9a628fc2bc1ebc82d1f6b6d360c3f5a895171cfd8a792541ab51f7509"},"output":{"address":"addr1q80y4whnp6y5ajfy8w9mj7khg9936vyxsvad30cj6yqnp5r2vrs4j05rcf6n6w8wvxpar47dkzsutjax2lre3zz3y2nqh3h7xa","amount":[{"unit":"lovelace","quantity":"445509838"}]}}',
);
const utxo3: cqLib.UTxO = JSON.parse(
  '{"input":{"outputIndex":0,"txHash":"cb78d0612a8a54e4cbe43c90e23dc7739f0b27fffbd7caa5368d9b98047601b1"},"output":{"address":"addr1wyvvjx7l749d3axnvxyp3umtn8jqrj48a2c48dp02yc3evqzypx02","amount":[{"unit":"lovelace","quantity":"2267060"},{"unit":"4d564c6e31f771d71471437ea9f0e60038be09619755f8720eb093cd","quantity":"1"},{"unit":"9e3ca7a4d3ae25b02b1ce833b8d85bd8a6a8fda186a93a0bc504d454","quantity":"1"},{"unit":"d30ee8c513b3fabada55d802a5ca5bb12e43b42027017309ed71ed4b","quantity":"1"}],"dataHash":"671a25e519487eeb4a3ec3abf857d5f0f561edae50386966e456572541ac7451","plutusData":"d8799f1b00002d79cfe23080ff","scriptRef":"8200830304868200581cde4abaf30e894ec9243b8bb97ad7414b1d3086833ad8bf12d10130d08200581caf62c226e169c1fb4e84eb4286bac6bfda702ecf3a49f9fdbe5bf78f8200581cd8c1b4ad263333c687291894fb466a3bc1429565c2541e54b8901e158200581c5d5bbb9f55ea3524307dd6ed28e72b156f60ffc181cc20b89f2f13338200581cb6ee5605641b0f573312699348d19e71765d0010a4cac2c4fc9678178200581cde398fc701ce1b4adb7119d68c1d9710cfb70dec6989e31acc6d274f","scriptHash":"4d564c6e31f771d71471437ea9f0e60038be09619755f8720eb093cd"}}',
);
const utxo4: cqLib.UTxO = JSON.parse(
  '{"input":{"outputIndex":1,"txHash":"125192e26ab0fedcfb32d54176d4cffdbde39b22f68d13f64c85bc7d64bd71a5"},"output":{"address":"addr1wypan0u8f2jsewz97nw0qydzy0k5k8xd2x6gtxgt4fuavastxq94l","amount":[{"unit":"lovelace","quantity":"6646020"}],"scriptRef":"820259053059052d01000032323232323232323232323232323232323232323232323232323232323232322223232323232323232323232323232323232323232325333033533303330363037002132323253302b33301d3021003012011153302b3301f33026002037375860660282a66056607060386eacc0cc04c4cdd79819981700d9819981700598101817998159981280081b1bac30320133031302c00130303031302b302d3302923302603530313032302c001375860600242646464a6605666603a00c0240222a6605666e3c00401854cc0accdc4801a410101a163a5fd341c2a6605666e252000003132323232323232533032533303d303f304100214a029444cdc398119bab303a01a0093041001375400aa6660746078004264068a66607200220662c2a666074607a004264068a66607200220662c2c607c00460780026ea8004ccccc0788c888c00800cc0f0004cdd2a40006605a98011e581ca2944573e99d2ed3055b808eaa264f0bf119e01fc6b18863067c63e4004bd701bab3033303430223034013200116302000f337026eb4c0c4c0b0064004dd69818181580408160b181b8009baa015301b302d302e3028301e013533302f3031002132029533302e0011028161533302f3032002132029533302e001102816163033002303100137540206030008a6660546058605c0042646404aa666054605200420482c6eb4c09c00458c0b8004dd5180a800981218129812980f80098101980e1980b180a980a004a5eb851e581c9e3ca7a4d3ae25b02b1ce833b8d85bd8a6a8fda186a93a0bc504d45400810140001bac3023004375660440046eb0c08400cc084c084004c080c080004c064c078c0640114ccc080c088c0900084c8c806d4ccc080c07c008406858dd6980e8008b18120009baa003233300e00148811ca2944573e99d2ed3055b808eaa264f0bf119e01fc6b18863067c63e4004881044d454c4400222533006330052323233533301f30223023002132223002003375c6038002244a002466e3c00401c52818118009baa301a3015300c001002133333004232223002003375660440026ea400c0049288a502223301722533301c00112250011533301d3375e604260340020082600a60340022600460360020024602844a666032002294054cc010c00cc05c0044c008c0600048cc05c00452891919299980c180d180e00109bae301500116301c001375460266004601c002460266026602600246464a66602c66e1d2004301a0021301300116301a0013754002464646666020600ca66602a60306032004260240022c6eb0c048c034c048c03400c800458c064004dd5180818089805800918079805180798081805000911299804198028010008998020018009119baf374e60120046e9cc024c038c02400488c94ccc044cdc4240040022c260280026660066eacc034c038c020004dd718068011bae300d300e0022223333004002480008cccc014009200075a6eac00400c8c8888cc034894ccc048004401454ccc04ccdd7980b980800080309802180c18080008980118088008009ba90012233300d00200114a04600e44a666018002297ae0132533300e30040011330050013003300c00213003300c002300a00157404601c6ea8005263002225333007001161533300835746600c0022600a0022c6002444a66600e002244a0022a6660106004600a002264446004006600a002266006004600c002464600446600400400246004466004004002ae855d12ab9f573497ae1011e581c1400f6b65c323065b3cad0bc73437884e3b9c4714624bde5cfe0132000810140001b8748000dc3a4004aae7555cf01","scriptHash":"18c91bdff54ad8f4d3618818f36b99e401caa7eab153b42f51311cb0"}}',
);
const utxo5: cqLib.UTxO = JSON.parse(
  '{"input":{"outputIndex":3,"txHash":"125192e26ab0fedcfb32d54176d4cffdbde39b22f68d13f64c85bc7d64bd71a5"},"output":{"address":"addr1wypan0u8f2jsewz97nw0qydzy0k5k8xd2x6gtxgt4fuavastxq94l","amount":[{"unit":"lovelace","quantity":"7779550"}],"scriptRef":"820259063759063401000032323232323232323232323232323232323232323232323232322232323232323253330145333014301c302200213301622533301900114a0264a66602ea66602e66e212002001161301f00114a22600660360046660246eacc050c068c044c050c068c044c050004dd7180a00d9bae3014301a01b37586024601e6024601e00e26464646464646464a66603860466054004264646464a6602c604e60426603246603201a603e604a60380026eb0c07802854cc058c0a0c08400c54cc058cdc3998111129998128008a4000264a66604666ebcc0c400401c4c94ccc09c0045854ccc090d5d198140008a99981219baf303230220014c0105444d454c44001375a606260440022c2c6eacc0c00044c00cc09c008c080004dd5980f0040008991919191919191929980f2999814299981419b8800200114a22a66605066e1c0080044c8c94ccc0a8c0c80104cdc41bad3028002375a60500022940c0d8010c0d40105280a511323232533302b533302b303300213232533302d3035303b00213375e6e9c00cdd38008a50303900137540102a666056606800426464a66605a606c6076004266ebcdd38019ba700114a060720026ea80204c8c94ccc0b4c0d0c0ec0084cdd79ba7003374e0022940c0e4004dd5004099981598101814981780598101814981780525114a0606e004606e0026ea80184c8c8c8c8c8c8c8cdc49bad302d3033302a00433302633029035330290354bd702400000ea66605c606a60780042646464646464066a66606c606e00420642c6eb4c0c0004c0d40114ccc0c0c0dcc0f80084c8c8c8c8c8c8c8c8c8c80e54ccc0f0c0f401440e0594ccc0e0c0fc0084c8c8c8c8c80f14ccc0fcc10001440ec594ccc0ecc1080084c8c8c8c8c80fd4ccc108c10c01440f8594ccc0f8c11400854ccc0f8c120dc69bae303c00113203e53330413042001103d16161533303e30460021533303e3048371a6eb8c0f00044c80f94ccc104c10800440f4585858c128008c128004dd5181c8008a99981d9821801099191919191902029998219822001081f8b1bad303d0013042002375a607600260800046eb4c0e400458c11c008c11c004dd5181b0008a99981c182000109901c299981d800881b8b0b182200118220009baa303300130380055333033303a00215333033303d371a6eb8c0c40044c80cd4ccc0d8c0dc00440c8585854ccc0ccc0ec00854ccc0ccc0f4dc69bae3031001132033533303630370011032161616303f002303f0013754605c0022c60780026ea8c0b000458c0e8004dd5000a999815981a181c801098148008b181b8009baa3027302d302d3024001302600b3035002303400237540046ea8008c084008c080008c07000cc06c01cccc0848894ccc09400440084cc00cccc0652f5c211e581c6ac8ef33b510ec004fe11585f7c5a9f0c07f0c23428ab4f29c1d7d10008105444d454c440000118100009813000a4000004605266030605466030981091b000001941f2891a0004bd701980c260103d87980004bd701980b180a8049bac301b006301a00116302800137546030603c00a602e603a6028602e603a603a603a0026038603800260366036002602260280026020010603e6601c60406601c98011e581cd612be7ab0bdbd3d728b922e422da843de33ee71bd13c19e78b32080004bd7019807181025eb812f5c020262c60400026ea80194ccc044c0600084c80454ccc05000440405854ccc044c0640084c80454ccc05000440405858c074008c074004dd50011180a180d1baa0012233300c00200114a044466e00ccc020dd59805180818038009bae300a003375c601460200060044466ebcdd398028011ba73005300830050012300a22533300d00114bd7009929998059802000899802800980198078010980198078011804000aba0230133754002444666600800490001199980280124000eb4dd58008019191111980511299980680088028a99980519baf30183008001006130043017300800113002300e0010013752002ae8526573466002444a66600a002200426600666e0000920023006001480008c8c0088cc0080080048c0088cc00800800555cfaba24bd70811e581c9e3ca7a4d3ae25b02b1ce833b8d85bd8a6a8fda186a93a0bc504d45400810140002601014000370e90001b8748008dc3a40086e1d2038374a90001ba54800955cf2ab9d1","scriptHash":"a2944573e99d2ed3055b808eaa264f0bf119e01fc6b18863067c63e4"}}',
);

const costModels: cqLib.CostModels = {
  plutusV1: [
    205665, 812, 1, 1, 1000, 571, 0, 1, 1000, 24177, 4, 1, 1000, 32, 117366,
    10475, 4, 23000, 100, 23000, 100, 23000, 100, 23000, 100, 23000, 100, 23000,
    100, 100, 100, 23000, 100, 19537, 32, 175354, 32, 46417, 4, 221973, 511, 0,
    1, 89141, 32, 497525, 14068, 4, 2, 196500, 453240, 220, 0, 1, 1, 1000,
    28662, 4, 2, 245000, 216773, 62, 1, 1060367, 12586, 1, 208512, 421, 1,
    187000, 1000, 52998, 1, 80436, 32, 43249, 32, 1000, 32, 80556, 1, 57667, 4,
    1000, 10, 197145, 156, 1, 197145, 156, 1, 204924, 473, 1, 208896, 511, 1,
    52467, 32, 64832, 32, 65493, 32, 22558, 32, 16563, 32, 76511, 32, 196500,
    453240, 220, 0, 1, 1, 69522, 11687, 0, 1, 60091, 32, 196500, 453240, 220, 0,
    1, 1, 196500, 453240, 220, 0, 1, 1, 806990, 30482, 4, 1927926, 82523, 4,
    265318, 0, 4, 0, 85931, 32, 205665, 812, 1, 1, 41182, 32, 212342, 32, 31220,
    32, 32696, 32, 43357, 32, 32247, 32, 38314, 32, 57996947, 18975, 10,
  ],
  plutusV2: [
    205665, 812, 1, 1, 1000, 571, 0, 1, 1000, 24177, 4, 1, 1000, 32, 117366,
    10475, 4, 23000, 100, 23000, 100, 23000, 100, 23000, 100, 23000, 100, 23000,
    100, 100, 100, 23000, 100, 19537, 32, 175354, 32, 46417, 4, 221973, 511, 0,
    1, 89141, 32, 497525, 14068, 4, 2, 196500, 453240, 220, 0, 1, 1, 1000,
    28662, 4, 2, 245000, 216773, 62, 1, 1060367, 12586, 1, 208512, 421, 1,
    187000, 1000, 52998, 1, 80436, 32, 43249, 32, 1000, 32, 80556, 1, 57667, 4,
    1000, 10, 197145, 156, 1, 197145, 156, 1, 204924, 473, 1, 208896, 511, 1,
    52467, 32, 64832, 32, 65493, 32, 22558, 32, 16563, 32, 76511, 32, 196500,
    453240, 220, 0, 1, 1, 69522, 11687, 0, 1, 60091, 32, 196500, 453240, 220, 0,
    1, 1, 196500, 453240, 220, 0, 1, 1, 1159724, 392670, 0, 2, 806990, 30482, 4,
    1927926, 82523, 4, 265318, 0, 4, 0, 85931, 32, 205665, 812, 1, 1, 41182, 32,
    212342, 32, 31220, 32, 32696, 32, 43357, 32, 32247, 32, 38314, 32, 35892428,
    10, 57996947, 18975, 10, 38887044, 32947, 10,
  ],
  plutusV3: [],
};

const pp: cqLib.ProtocolParameters = {
  minFeeCoefficientA: 44n,
  minFeeConstantB: 155381n,
  maxBlockBodySize: 90112,
  maxTransactionSize: 16384,
  maxBlockHeaderSize: 1100,
  stakeKeyDeposit: 2000000n,
  stakePoolDeposit: 500000000n,
  maxEpochForPoolRetirement: 18,
  protocolVersion: [9, 1],
  minPoolCost: 170000000n,
  adaPerUtxoByte: 4310n,
  costModels: costModels, // from mesh default
  executionPrices: {
    memPrice: {
      numerator: 577n,
      denominator: 10_000n,
    },
    stepPrice: {
      numerator: 721n,
      denominator: 10_000_000n,
    },
  },
  maxTxExecutionUnits: {
    mem: 14000000,
    steps: 10000000000,
  },
  maxBlockExecutionUnits: {
    mem: 62000000,
    steps: 20000000000,
  },
  maxValueSize: 5000,
  collateralPercentage: 150,
  maxCollateralInputs: 3,
  governanceActionDeposit: 100000000000n,
  drepDeposit: 500000000n,
  referenceScriptCostPerByte: {
    numerator: 0n,
    denominator: 1000n,
  },
};

const context: cqLib.ValidationInputContext = {
  accountContexts: [],
  committeeContext: {
    activeCommitteeMembers: [],
    potentialCommitteeMembers: [],
    resignedCommitteeMembers: [],
  },
  drepContexts: [],
  govActionContexts: [],
  lastEnactedGovAction: [],
  networkType: "mainnet",
  poolContexts: [],
  protocolParameters: pp, // from mesh default
  slot: 1000000n,
  treasuryValue: 0n,
  utxoSet: [
    {
      utxo: utxo1,
      isSpent: false,
    },
    {
      utxo: utxo2,
      isSpent: false,
    },
    {
      utxo: utxo3,
      isSpent: false,
    },
    {
      utxo: utxo4,
      isSpent: false,
    },
    {
      utxo: utxo5,
      isSpent: false,
    },
  ],
};

// cost models from mesh constant
// const costModels: cqLib.CostModels = {
//   plutusV1: DEFAULT_V1_COST_MODEL_LIST,
//   plutusV2: DEFAULT_V2_COST_MODEL_LIST,
//   plutusV3: DEFAULT_V3_COST_MODEL_LIST,
// };

// annotation for the protocol parameters
// const pp: cqLib.ProtocolParameters = {
//   // blockforst type
//   minFeeCoefficientA: 44, // min_fee_a
//   minFeeConstantB: 155381, // min_fee_b
//   maxBlockBodySize: 90112, // max_block_size
//   maxTransactionSize: 16384, // max_tx_size
//   maxBlockHeaderSize: 1100, // max_block_header_size
//   stakeKeyDeposit: 2000000, // key_deposit
//   stakePoolDeposit: 500000000, // pool_deposit
//   maxEpochForPoolRetirement: 18, // e_max
//   protocolVersion: [9, 1], // [protocol_major_ver, protocol_minor_ver]
//   minPoolCost: 170000000, // min_pool_cost
//   adaPerUtxoByte: 4310, // coins_per_utxo_size!!
//   costModels: costModels, // from mesh default // v // cost_models_raw
//   executionPrices: {
//     memPrice: {
//       numerator: 577, // price_mem * 10000
//       denominator: 10_000,
//     },
//     stepPrice: {
//       numerator: 721, // price_step * 10000000
//       denominator: 10_000_000,
//     },
//   },
//   maxTxExecutionUnits: {
//     mem: 14000000, // max_tx_ex_mem
//     steps: 10000000000, // max_tx_ex_steps
//   },
//   maxBlockExecutionUnits: {
//     mem: 62000000, // max_block_ex_mem
//     steps: 20000000000, // max_block_ex_steps
//   },
//   maxValueSize: 5000, // max_val_size
//   collateralPercentage: 150, // collateral_percent
//   maxCollateralInputs: 3, // max_collateral_inputs
//   governanceActionDeposit: 100000000000, // gov_action_deposit
//   drepDeposit: 500000000, // drep_deposit
//   referenceScriptCostPerByte: {
//     numerator: 0, // min_fee_ref_script_cost_per_byte
//     denominator: 1000, // chnage to 1?
//   },
// };

const json4 = cqLib.validate_transaction_js(
  "84a900838258206153c1e9a628fc2bc1ebc82d1f6b6d360c3f5a895171cfd8a792541ab51f7509018258206153c1e9a628fc2bc1ebc82d1f6b6d360c3f5a895171cfd8a792541ab51f750902825820cb78d0612a8a54e4cbe43c90e23dc7739f0b27fffbd7caa5368d9b98047601b1000183a400581d7118c91bdff54ad8f4d3618818f36b99e401caa7eab153b42f51311cb001821a002297b4a2581c9e3ca7a4d3ae25b02b1ce833b8d85bd8a6a8fda186a93a0bc504d454a14001581cd30ee8c513b3fabada55d802a5ca5bb12e43b42027017309ed71ed4ba14001028201d8184dd8799f1b00003b1e458e2080ff03d81858c68200830304868200581cde4abaf30e894ec9243b8bb97ad7414b1d3086833ad8bf12d10130d08200581caf62c226e169c1fb4e84eb4286bac6bfda702ecf3a49f9fdbe5bf78f8200581cd8c1b4ad263333c687291894fb466a3bc1429565c2541e54b8901e158200581c5d5bbb9f55ea3524307dd6ed28e72b156f60ffc181cc20b89f2f13338200581cb6ee5605641b0f573312699348d19e71765d0010a4cac2c4fc9678178200581cde398fc701ce1b4adb7119d68c1d9710cfb70dec6989e31acc6d274f82583901de4abaf30e894ec9243b8bb97ad7414b1d3086833ad8bf12d10130d06a60e1593e83c2753d38ee6183d1d7cdb0a1c5cba657c798885122a6821a001b9f18a4581c6ac8ef33b510ec004fe11585f7c5a9f0c07f0c23428ab4f29c1d7d10a1444d454c441a004c4b40581ca0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235a145484f534b591a0134fd9a581ca2944573e99d2ed3055b808eaa264f0bf119e01fc6b18863067c63e4a1444d454c441b000000037e2100d0581cb06729158210bf1ba13f8f3d7d422a918d3eaa82561a705552a2568ba158194d656c642042616e6b204d616e6167657220763120333939370182583901de4abaf30e894ec9243b8bb97ad7414b1d3086833ad8bf12d10130d06a60e1593e83c2753d38ee6183d1d7cdb0a1c5cba657c798885122a61a1a895ce7021a00042ee309a2581c4d564c6e31f771d71471437ea9f0e60038be09619755f8720eb093cda14020581ca2944573e99d2ed3055b808eaa264f0bf119e01fc6b18863067c63e4a1444d454c443b00000da475abefff0b58201b22ceb7916b9a373af4c0bcd14d59bfc3f0bb88702f5f6214463ae2dc94a9df0d818258206153c1e9a628fc2bc1ebc82d1f6b6d360c3f5a895171cfd8a792541ab51f7509021082583901de4abaf30e894ec9243b8bb97ad7414b1d3086833ad8bf12d10130d06a60e1593e83c2753d38ee6183d1d7cdb0a1c5cba657c798885122a61a1a87aa79111a000646551283825820125192e26ab0fedcfb32d54176d4cffdbde39b22f68d13f64c85bc7d64bd71a501825820125192e26ab0fedcfb32d54176d4cffdbde39b22f68d13f64c85bc7d64bd71a503825820cb78d0612a8a54e4cbe43c90e23dc7739f0b27fffbd7caa5368d9b98047601b100a2008482582059b84d8bda14d930893c601db44a4868206bb86e4d413637e19f9e8fb48e1103584051a8a5f8725842b78877e9852c6277bae5bb4b67cdbfe12311b63a64b1097eccafb8c26012e713b45842652fa5e2490f9ecdbdb4cb8a5b5006a529e1d814a20f825820772009ced9a45528d3a8b917eedd09949b724c07d7e0ffb1bced31dd0692acc85840cf655e22856912723907977cade87a887cba8e9e928d61efa6c600c03d4155f9b0caa76ec59270a6dbfb9091258106584416ea24ac68a3ea6de9c33065782405825820485e86a93ed036d20336391aab0419bf4cf2a7b47fbe7b62f8a0fa912954ecb8584051af180e31ce6baca4b404e7a3d4b942362dd36938dc2e3fe86dfb9388bc3ddd290821850080d8bf2e92f1d43e36c6cfcedb6f2bbf1823bec0e6aafbe113c3008258209e0fc2bceae4ffe26fffd8a91dcc7cd4578843415434ff565696b5ffd5ec1e725840dc28ca94bfd9070507e4ed8223afdd3f08e10790f6a86c08111523defa7fa84b6851c7f4276d25757a2f945cb72b9609e687e39085905ce33f04986b9c83af010582840002d87980821a0004bd501a07f45cee840101d87a80821a000191e71a02b3b3f4F6F5",
  JSONbig.stringify(context),
);
console.log(json4);

const result: cqLib.ValidationResult = JSONbig.parse(json4);
